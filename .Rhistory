write.csv(surv_eps,"./tables/Survey_epsilon_byM.csv",row.names = FALSE)
write.csv(surv_by,"./tables/Survey_biomass_byM.csv",row.names = FALSE)
write.csv(surv_eps,"./_writing/tables/Survey_epsilon_byM.csv",row.names = FALSE)
write.csv(surv_by,"./_writing/tables/Survey_biomass_byM.csv",row.names = FALSE)
surv_eps <- surv %>%
distinct() %>%
filter(Fleet != 'AllAreas' & Fleet != "Eastern_Bering_Sea") %>%
mutate(By = round(Estimate_metric_tons), Epsilon = SD_log) %>%
select(Year, Fleet, Epsilon) %>%
pivot_wider(., values_from = c("Epsilon"), names_from = "Fleet")
names(surv_eps)[c(4,5)] <- c("AK (A1 + A2)", "AK (A1)")
write.csv(surv_eps,"./_writing/tables/Survey_epsilon_byM.csv",row.names = FALSE)
distinct() %>%
filter(Fleet != 'AllAreas' & Fleet != "Eastern_Bering_Sea") %>%
mutate(By = round(Estimate_metric_tons), Epsilon = round(SD_log,3)) %>%
select(Year, Fleet, Epsilon) %>%
pivot_wider(., values_from = c("Epsilon"), names_from = "Fleet")
names(surv_eps)[c(4,5)] <- c("AK (A1 + A2)", "AK (A1)")
write.csv(surv_eps,"./_writing/tables/Survey_epsilon_byM.csv",row.names = FALSE)
ypreds <- read.csv("./input/raw/SAB_predicts_2020-04-17.csv")
ypreds$gamREG <- ypreds$gamREG
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
ypreds <- read.csv("./input/raw/SAB_predicts_2020-04-17.csv")
levels(ypreds$REG)
levels(ypreds$Sex)
head(ypreds)
ypreds <- read.csv("./input/raw/SAB_predicts_2020-04-17.csv")
levels(ypreds$REG)
# ypreds$gamREG <- ypreds$gamREG
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
saveRDS(fd_summary_gamREG, file = "./_writing/figures/OMGrowthCurves.Rdata")
ggplot(readRDS("./_writing/figures/OMGrowthCurves.Rdata"), aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
require(ggplot2)
ggplot(readRDS("./_writing/figures/OMGrowthCurves.Rdata"), aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
cbbPalette <- c("#000000", "#009E73", "#e79f00", "#9ad0f3",
"#0072B2", "#D55E00", "#CC79A7", "navy", "#F0E442" )
ggplot(readRDS("./_writing/figures/OMGrowthCurves.Rdata"), aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
head(fd_summary_gamREG)
ggsave(plot = last_plot(),
file = "./_writing/figures/OMGrowthCurves.PNG",
height = 8, width = 10, unit = 'in')
ggplot(readRDS("./_writing/figures/OMGrowthCurves.Rdata"), aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette,
labels = c('Stock R1 (South CC)',
'Stock R2 (North CC/South BC)',
'Stock R3 (BC)',
'Stock R4 (West BC/AK Gulf)',
'Stock R5 (West Gulf/Aleutians)')) +
scale_fill_manual(values = cbbPalette,
labels = c('Stock R1 (South CC)',
'Stock R2 (North CC/South BC)',
'Stock R3 (BC)',
'Stock R4 (West BC/AK Gulf)',
'Stock R5 (West Gulf/Aleutians)')) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(readRDS("./_writing/figures/OMGrowthCurves.Rdata"), aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) + theme(legend.position = 'right') +
scale_color_manual(values = cbbPalette,
labels = c('Stock R1 (South CC)',
'Stock R2 (North CC/South BC)',
'Stock R3 (BC)',
'Stock R4 (West BC/AK Gulf)',
'Stock R5 (West Gulf/Aleutians)')) +
scale_fill_manual(values = cbbPalette,
labels = c('Stock R1 (South CC)',
'Stock R2 (North CC/South BC)',
'Stock R3 (BC)',
'Stock R4 (West BC/AK Gulf)',
'Stock R5 (West Gulf/Aleutians)')) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggsave(plot = last_plot(),
file = "./_writing/figures/OMGrowthCurves.PNG",
height = 8, width = 10, unit = 'in')
xaringan:::inf_mr()
xaringan:::inf_mr()
1-e^-0.2
1-exp^-0.2
1-exp^(-0.2)
1-exp^(-0.2)
exp(1)
exp(-.2)
1-exp^(-.2)
1-exp^=(-.2)
1-exp(-.2)
1-exp(1)
1-exp(0.3)
eq2 <- function(Lnow, K, Linf){}
dat <- data.frame("age" = 1:95, "len" = NA)
dat[1,"len"] <- 2
dat[1,"len"] <- 2
for(i in 2:nrow(dat)){
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
with(dat, plot(len ~ age))
eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
dat
i
dat[i-1,"len"]
eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
eq2 <- function(Lnow, K, Linf){
lthen = lnow - (Linf - lnow)(1-exp(-K))
return(lthen)
}
dat <- data.frame("age" = 1:95, "len" = NA)
dat[1,"len"] <- 2
for(i in 2:nrow(dat)){
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
eq2 <- function(Lnow, K, Linf){
lthen = lnow - (Linf - Lnow)(1-exp(-K))
return(lthen)
}
dat <- data.frame("age" = 1:95, "len" = NA)
dat[1,"len"] <- 2
for(i in 2:nrow(dat)){
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
eq2 <- function(Lnow, K, Linf){
lthen = lnow - (Linf - Lnow)(1-exp(-K))
return(lthen)
}
for(i in 2:nrow(dat)){
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
eq2 <- function(Lnow, K, Linf){
lthen = Lnow - (Linf - Lnow)(1-exp(-K))
return(lthen)
}
for(i in 2:nrow(dat)){
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
eq2
eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
eq2 <- function(Lnow, K, Linf){
lthen = Lnow - (Linf - Lnow)*(1-exp(-K))
return(lthen)
}
dat <- data.frame("age" = 1:95, "len" = NA)
dat[1,"len"] <- 2
for(i in 2:nrow(dat)){
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
with(dat, plot(len ~ age))
dat[i,"len"]
for(i in 2:nrow(dat)){
dat[i,"linflnow"] = Linf - dat[i-1,"len"]
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
with(dat, plot(len ~ age))
for(i in 2:nrow(dat)){
dat[i,"linflnow"] = 150 - dat[i-1,"len"]
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
with(dat, plot(len ~ age))
dat
eq2 <- function(Lnow, K, Linf){
lthen = Lnow + (Linf - Lnow)*(1-exp(-K))
return(lthen)
}
dat <- data.frame("age" = 1:95, "len" = NA, "linflnow" = NA)
dat[1,"len"] <- 2
for(i in 2:nrow(dat)){
dat[i,"linflnow"] = 150 - dat[i-1,"len"]
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.2,Linf = 150)
}
with(dat, plot(len ~ age))
growth <- function(k, lmin, lmax, ages, a3, a4)
{
len      <- matrix(NA, ages, 1)
a.linear <- a3 ## age at which linear growth stops
len.step <- ifelse(lmin < 4, lmin, 4)  ## lmin is size at age 0 (?)
#L infinity (cm)
Linf <- lmax + ((lmax - lmin) / (1 - exp( -k * (a4 - a3))))
len.slope <- (lmin - len.step) / a3 ## linear growth slope
# Length at the start of the year (cm)
len[1:(a.linear+1),1]<-len.step[1]+len.slope*(seq(1, (a.linear + 1), 1) - 1)
# Growth based on the VB
len[(a.linear+2):ages,1] <- Linf + (lmin - Linf)*exp(-k*((seq(a.linear+2, ages,1)-1)-a3))
# Growth based on the VB
len[1:ages,1] <- Linf + (lmin - Linf)*exp(-k*(1:ages))
#Plus Group Growth
temp1 <- sum(exp(-0.20*(ages:(ages*2)-ages))*(len[ages,1]+((ages:(ages*2)-ages)/ages)*(Linf-len[ages,1])))
temp2 <- sum(exp(-0.20*(ages:(ages*2)-ages)))
len[ages,1] <- temp1 / temp2
return(len)
}
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
dat <- data.frame("age" = 1:95, "len" = NA, "linflnow" = NA)
dat[1,"len"] <- 2
for(i in 2:nrow(dat)){
dat[i,"linflnow"] = 65 - dat[i-1,"len"]
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.3,Linf = 65)
}
# with(dat, plot(len ~ age))
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, plot(len ~ age, add = TRUE, col = blue))
with(dat, plot(len ~ age, add = TRUE, color = "blue")
)
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, plot(len ~ age, add = TRUE, color = "blue"))
with(dat, points(len ~ age, add = TRUE, color = "blue"))
warnings()
with(dat, points(len ~ age, add = TRUE, col = "blue"))
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, points(len ~ age, add = TRUE, col = "blue"))
dat[1,"len"] <- 4.5
for(i in 2:nrow(dat)){
dat[i,"linflnow"] = 65 - dat[i-1,"len"]
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.3,Linf = 65)
}
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, points(len ~ age, add = TRUE, col = "blue"))
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, points(len ~ age,  col = "blue"))
graphics.off()
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, points(len ~ age,  col = "blue"))
k = 0.3
lmin = 4.5
lmax = 65
ages = 95
a3 = 3
a4 = 70
#L infinity (cm)
Linf <- lmax + ((lmax - lmin) / (1 - exp( -k * (a4 - a3)))) ## years of VB growth
Linf
dat[1,"len"] <- 4.5
for(i in 2:nrow(dat)){
dat[i,"linflnow"] = 125.5 - dat[i-1,"len"]
dat[i,"len"] <- eq2(Lnow = dat[i-1,"len"],K = 0.3,Linf = 125.5)
}
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70))
with(dat, points(len ~ age,  col = "blue"))
legend('bottomright', col = c('black","blue'), legend = c('Synthesis', "Shire"))
legend('bottomright', col = c('black","blue'), type = 'p', legend = c('Synthesis', "Shire"))
legend('bottomright', col = c('black","blue'), pch = 1, legend = c('Synthesis', "Shire"))
legend('bottomright', col = c("black","blue"), pch = 1, legend = c('Synthesis', "Shire"))
legend('bottomright', col = c("black","blue"), pch = 20, legend = c('Synthesis', "Shire"))
plot(1:95, growth(k = 0.3, lmin = 4.5, lmax = 65, ages = 95, a3 = 3, a4 = 70), pch = 20) ## LMAX IS NOT LINF
with(dat, points(len ~ age,  col = "blue", pch = 20))
legend('bottomright', col = c("black","blue"), pch = 20, legend = c('Synthesis', "Shire"))
dat <- data.frame("age" = 1:ages, "len" = c(Lstart, rep(NA, ages-1)))
## setup tester params
ages = 95
Lstart = 4.5 ## length at age 1
K = 0.3
Linf = 150
dat <- data.frame("age" = 1:ages, "len" = c(Lstart, rep(NA, ages-1)))
dat
for(i in 2:(ages-1)){
dat$len[i] <-  eq2(Lnow = dat[i-1,"len"],K, Linf)
}
dat
Plus_LI <- function(Natage, Lmid, Lstart, Lnow){
lthen0 <- Natage[1]*Lmid[ages]+Natage[2]*vonB(Lnow, K,Linf)
lthen1 <- sum(Natage)
lthen = lthen0/lthen1
return(lthen)
}
Plus_LI <- function(Natage, Lmid, Lnow){
lthen0 <- Natage[1]*Lmid[ages]+Natage[2]*vonB(Lnow, K,Linf)
lthen1 <- sum(Natage)
lthen = lthen0/lthen1
return(lthen)
}
for(i in 2:(ages)){
if(i == ages){
dat$len_y1[i] <-  vonB(Lnow = dat[i-1,"len"],K, Linf) ## start of next year
dat$len_y0.5[i] <-  vonBmid(Lnow = dat[i-1,"len"],K, Linf) ## midpoint of this year
} else{
## plus group
dat$len_y1[i] <- Plus_LI(Natage = c(100,96), Lmid =   dat$len_y0.5[i],
Lnow = dat[i-1,"len"])
}
}
vonB <- function(Lnow, K, Linf){
lthen = Lnow + (Linf - Lnow)*(1-exp(-K))
return(lthen)
}
vonBmid <- function(Lnow, K, Linf){
lthen = Lnow + (Linf - Lnow)*(1-exp(-0.5*K))
return(lthen)
}
Plus_LI <- function(Natage, Lmid, Lnow){
lthen0 <- Natage[1]*Lmid[ages]+Natage[2]*vonB(Lnow, K,Linf)
lthen1 <- sum(Natage)
lthen = lthen0/lthen1
return(lthen)
}
for(i in 2:(ages)){
if(i == ages){
dat$len_y1[i] <-  vonB(Lnow = dat[i-1,"len"],K, Linf) ## start of next year
dat$len_y0.5[i] <-  vonBmid(Lnow = dat[i-1,"len"],K, Linf) ## midpoint of this year
} else{
## plus group
dat$len_y1[i] <- Plus_LI(Natage = c(100,96), Lmid =   dat$len_y0.5[i],
Lnow = dat[i-1,"len"])
}
}
dat
for(i in 2:(ages)){
if(i != ages){
dat$len_y1[i] <-  vonB(Lnow = dat[i-1,"len"],K, Linf) ## start of next year
dat$len_y0.5[i] <-  vonBmid(Lnow = dat[i-1,"len"],K, Linf) ## midpoint of this year
} else{
## plus group
dat$len_y1[i] <- Plus_LI(Natage = c(100,96), Lmid =   dat$len_y0.5[i],
Lnow = dat[i-1,"len"])
}
}
dat
dat <- data.frame("age" = 1:ages,
"len_y1" = c(Lstart, rep(NA, ages-1)),
"len_y0.5" = c(Lstart, rep(NA, ages-1)))
for(i in 2:(ages)){
## do them all
dat$len_y1[i] <-  vonB(Lnow = dat[i-1,"len"],K, Linf) ## start of next year
dat$len_y0.5[i] <-  vonBmid(Lnow = dat[i-1,"len"],K, Linf) ## midpoint of this year
if(i != ages){  ## plus group
dat$len_y1[i] <- Plus_LI(Natage = c(100,96), Lmid =   dat$len_y0.5[i],
Lnow = dat[i-1,"len"])
}
}
i
vonB(Lnow = dat[i-1,"len"],K, Linf) #
dat <- data.frame("age" = 1:ages,
"len_y1" = c(Lstart, rep(NA, ages-1)),
"len_y0.5" = c(Lstart, rep(NA, ages-1)))
dat
vonB(Lnow = dat[i-1,"len"],K, Linf) #
dat <- matrix(NA, ncol = ages, nrow = 100)
head(dat)
row.names(dat) = seq(1,50,0.5)
seq(1,50,0.5)
length( seq(1,50,0.5))
colnames(dat) <- 1:ages
dat[1,1] <- Lstart
for(i in 1:nrow(dat)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[i+1,j] <- vonBmid(Lnow)
dat[i+1,j] <- vonB(Lnow)
}
}
for(i in 1:nrow(dat)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[i+1,j] <- vonBmid(Lnow = dat[i,j])
dat[i+1,j] <- vonB(Lnow = dat[i,j])
}
}
for(i in 1:nrow(dat)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
dat[i+1,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
dat
apply(dat[1,2:ages],2,vonB)
?apply
apply(dat[1,2:ages],2,vonB)
dat[1,1] <- Lstart
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,1]-Linf)*exp(-K)
dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
dat
require(ggplot2)
require(dplyr)
dat %>%
data.frame() %>%
reshape2::melt()
dat %>%
data.frame() %>%
dat %>%
# data.frame() %>%
reshape2::melt()
head(dat)
dat <- matrix(NA, ncol = ages, nrow = 100)
row.names(dat) = seq(0.5,50,0.5)
colnames(dat) <- 1:ages
dat[1,1] <- Lstart
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,1]-Linf)*exp(-K)
# dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
# dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
dat
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 1:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,j-1]- Linf)*exp(-K)
# dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
# dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
dat[1,j-1]
j
dat <- matrix(NA, ncol = ages, nrow = 100)
row.names(dat) = seq(0.5,50,0.5)
colnames(dat) <- 1:ages
dat[1,1] <- Lstart
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 2:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,j-2]- Linf)*exp(-K)
}
# for(j in 1:ncol(dat))
# dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
# dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 2:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,j-1]- Linf)*exp(-K)
}
# for(j in 1:ncol(dat))
# dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
# dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
dat
plot(1:95, dat[1,])
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 2:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,j-1]- Linf)*exp(-K)
}
for(j in 1:ncol(dat)){
# dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
# dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
dat
for(i in 1:(nrow(dat)-2)){ ## loop years
for(j in 2:ncol(dat)){ ## loop ages
dat[1,j] <- Linf + (dat[1,j-1]- Linf)*exp(-K)
}
for(j in 1:ncol(dat)){
dat[i+1,j] <- vonBmid(Lnow = dat[i,j],K, Linf)
dat[i+2,j] <- vonB(Lnow = dat[i,j], K, Linf)
}
}
dat
dat %>%
reshape2::melt()
dat %>%
reshape2::melt() %>%
ggplot(., aes(x = Var2, y = value, color = Var1 )) +
geom_line()
dat %>%
reshape2::melt() %>%
ggplot(., aes(x = Var2, y = value, color = Var1, group = Var1)) +
geom_line()
xaringan:::inf_mr()
xaringan:::inf_mr()
xaringan:::inf_mr()
