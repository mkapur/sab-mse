scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
readRDS("./OM2_RegionalCurves.Rdata") %>%
ggplot(., aes(x = Age, col = gamREG, group = gamREG)) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
cbbPalette <- c("#000000", "#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00", "#CC79A7", "navy", "#F0E442" )
readRDS("./OM2_RegionalCurves.Rdata") %>%
ggplot(., aes(x = Age, col = gamREG, group = gamREG)) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
# guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
# guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
read.csv("C:/Users/mkapur/Downloads/SAB_predicts_2019-10-04_phase2.csv") %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
readRDS("./OM2_RegionalCurves.Rdata") %>%
ggplot(., aes(x = Age, y = meanPred, col = gamREG,group = gamREG)) +
kaputils::theme_mk() +
geom_line() +
facet_grid(~Sex + Period)
readRDS("./OM2_RegionalCurves.Rdata") %>%
ggplot(., aes(x = Age, y = meanPred, col = gamREG)) +
kaputils::theme_mk() +
geom_line() +
facet_grid(~Sex + Period)
readRDS("./OM2_RegionalCurves.Rdata") %>%
ggplot(., aes(x = Age, y = meanPred, col = gamREG)) +
kaputils::theme_mk() +
geom_line() +
facet_grid(~Sex + Period)
unique(om2growth$Period)
## OM2 uses values from kapur et al. 2019
read.csv("C:/Users/mkapur/Downloads/SAB_predicts_2019-10-04_phase2.csv") %>% head()
ypreds <- read.csv("C:/Users/mkapur/Downloads/SAB_predicts_2019-10-04_phase2.csv")
ypreds$gamREG <- paste0('GAM-Detected ',ypreds$gamREG)
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
ggplot(ypreds, aes(x = Age, y = Predicted, col = REG, linetype = Period )) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
guides(shape = FALSE) +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('black','grey22','grey44','grey77'),
guide = guide_legend(override.aes = list(
shape = c(15:17),
linetype = c("solid", "dashed", "dotted")))) +
geom_point(alpha = 0.2, aes(y = Length_cm, shape = REG, col = REG)) +
geom_line(lwd = 1.1, col = 'black')+
labs(y = 'Length (cm)', x= 'Age (years)', col = "Actual Data Source") +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"))+
facet_wrap(~gamREG + Sex , ncol = 4)
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
theme_classic() +
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.background = element_blank(),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
geom_point(data = ypreds, alpha = 0.5,
aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ypreds <- read.csv("C:/Users/mkapur/Downloads/SAB_predicts_2019-10-04_phase2.csv")
ypreds$gamREG <- ypreds$gamREG
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
saveRDS(fd_summary_gamREG, file = "./OM2_RegionalCurves.Rdata")
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
# theme_classic() +
# theme(panel.grid = element_blank(),
#       legend.position = 'right',
#       legend.background = element_blank(),
#       axis.text = element_text(size = 10),
#       axis.title = element_text(size = 10),
#       legend.text = element_text(size = 10),
#       strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
# theme_classic() +
# theme(panel.grid = element_blank(),
#       legend.position = 'right',
#       legend.background = element_blank(),
#       axis.text = element_text(size = 10),
#       axis.title = element_text(size = 10),
#       legend.text = element_text(size = 10),
#       strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
guide = guide_legend(override.aes = list(
linetype = c(NA,NA,rep(1,5),NA),
shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
# theme_classic() +
# theme(panel.grid = element_blank(),
#       legend.position = 'right',
#       legend.background = element_blank(),
#       axis.text = element_text(size = 10),
#       axis.title = element_text(size = 10),
#       legend.text = element_text(size = 10),
#       strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
# scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
#                     guide = guide_legend(override.aes = list(
#                       linetype = c(NA,NA,rep(1,5),NA),
#                       shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) + theme(legend.position = c(0.75,0.75))+
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +  # theme_classic() +
# theme(panel.grid = element_blank(),
#       legend.position = 'right',
#       legend.background = element_blank(),
#       axis.text = element_text(size = 10),
#       axis.title = element_text(size = 10),
#       legend.text = element_text(size = 10),
#       strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
# scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
#                     guide = guide_legend(override.aes = list(
#                       linetype = c(NA,NA,rep(1,5),NA),
#                       shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +  # theme_classic() +
# theme(panel.grid = element_blank(),
#       legend.position = 'right',
#       legend.background = element_blank(),
#       axis.text = element_text(size = 10),
#       axis.title = element_text(size = 10),
#       legend.text = element_text(size = 10),
#       strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
# scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
#                     guide = guide_legend(override.aes = list(
#                       linetype = c(NA,NA,rep(1,5),NA),
#                       shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
theme(strip.background = 'grey55') +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +  # theme_classic() +
# theme(panel.grid = element_blank(),
#       legend.position = 'right',
#       legend.background = element_blank(),
#       axis.text = element_text(size = 10),
#       axis.title = element_text(size = 10),
#       legend.text = element_text(size = 10),
#       strip.text = element_text(size=10))+
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
# scale_colour_manual(values = c('grey66','grey44',cbbPalette[1:5],'grey22'),
#                     guide = guide_legend(override.aes = list(
#                       linetype = c(NA,NA,rep(1,5),NA),
#                       shape = c(15,16,rep(NA,5),17)))) +
# geom_point(data = ypreds, alpha = 0.5,
#            aes(x = Age, y = Length_cm, pch = REG, col = REG))+
guides(pch = FALSE) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
# scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
ypreds <- read.csv("C:/Users/mkapur/Downloads/ONEREG_SAB_predicts_2019-10-29.csv")
ypreds$gamREG <- ypreds$gamREG
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
saveRDS(fd_summary_gamREG, file = "./OM3_RangewideCurve.Rdata")
readRDS("./OM3_RangewideCurve.Rdata")
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
saveRDS(fd_summary_gamREG, file = "./OM3_RangewideCurve.Rdata")
readRDS("./OM3_RangewideCurve.Rdata")
ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
fd_summary_gamREG
p3 <- ggplot(fd_summary_gamREG, aes(x = Age)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
p3
ggplot(fd_summary_gamREG, aes(x = Age)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex , ncol = 4)
p3 <- ggplot(fd_summary_gamREG, aes(x = Age)) +
kaputils::theme_mk(base_size = 16) +theme(legend.position = 'none') +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex , ncol = 4)
ggsave(plot = (p1  | p2  / p3),
file = paste0("./figures/Fig2_OM_indices.png"),
width = 17, height = 10, units = 'in', dpi = 720)
ggsave(plot = (p2  / p3),
file = paste0("./figures/FigX_GrowthCurves.png"),
width = 17, height = 10, units = 'in', dpi = 720)
p2 <- ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
p3 <- ggplot(fd_summary_gamREG, aes(x = Age)) +
kaputils::theme_mk(base_size = 16) +theme(legend.position = 'none') +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex , ncol = 4)
ggsave(plot = (p2  / p3),
file = paste0("./figures/FigX_GrowthCurves.png"),
width = 17, height = 10, units = 'in', dpi = 720)
# saveRDS(fd_summary_gamREG, file = "./OM2_RegionalCurves.Rdata")
readRDS("./OM2_RegionalCurves.Rdata")
p2 <- ggplot(fd_summary_gamREG, aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
## use ONEREG from dropbox
# ypreds <- read.csv("C:/Users/mkapur/Downloads/ONEREG_SAB_predicts_2019-10-29.csv")
# ypreds$gamREG <- ypreds$gamREG
# levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
# levels(ypreds$Sex) <- c('Females','Males')
# levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
# for(i in 1:nrow(ypreds)){
#   ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
#                               'All Years', paste(ypreds$Period[i]))
# }
# fd_summary_gamREG <- ypreds %>%
#   # filter(Age < 75) %>%
#   group_by(Age, Sex, gamREG,Period) %>%
#   dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
#
# saveRDS(fd_summary_gamREG, file = "./OM3_RangewideCurve.Rdata")
readRDS("./OM3_RangewideCurve.Rdata")
p3 <- ggplot(fd_summary_gamREG, aes(x = Age)) +
kaputils::theme_mk(base_size = 16) +theme(legend.position = 'none') +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex , ncol = 4)
ggsave(plot = (p2  / p3),
file = paste0("./figures/FigX_GrowthCurves.png"),
width = 17, height = 10, units = 'in', dpi = 720)
readRDS("./OM2_RegionalCurves.Rdata")
ypreds <- read.csv("C:/Users/mkapur/Downloads/SAB_predicts_2019-10-04_phase2.csv")
ypreds$gamREG <- ypreds$gamREG
levels(ypreds$REG) <- c('Alaska','British Columbia','US West Coast')
levels(ypreds$Sex) <- c('Females','Males')
levels(ypreds$Period) <- c('pre-2010','2010-2018','All Years')
for(i in 1:nrow(ypreds)){
ypreds$Period[i] <-  ifelse(length(grep('pool', ypreds$cREG[i])) == 1,
'All Years', paste(ypreds$Period[i]))
}
fd_summary_gamREG <- ypreds %>%
# filter(Age < 75) %>%
group_by(Age, Sex, gamREG,Period) %>%
dplyr::summarise(meanL = mean(Length_cm), sdmeanL = sd(Length_cm), meanPred = mean(Predicted))
saveRDS(fd_summary_gamREG, file = "./OM2_RegionalCurves.Rdata")
rm(om2growth)
rm(ypreds)
readRDS("./OM2_RegionalCurves.Rdata")
p2 <- ggplot(readRDS("./OM2_RegionalCurves.Rdata"), aes(x = Age, col = gamREG, group = gamREG)) +
kaputils::theme_mk(base_size = 16) +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex +Period, ncol = 4)
p3 <- ggplot(readRDS("./OM3_RangewideCurve.Rdata"), aes(x = Age)) +
kaputils::theme_mk(base_size = 16) +theme(legend.position = 'none') +
scale_color_manual(values = cbbPalette) +
scale_fill_manual(values = cbbPalette) +
scale_alpha(guide = 'none') +
scale_y_continuous(limits = c(0,110)) +
scale_x_continuous(limits = c(0,65)) +
geom_line(aes(y = meanPred, col = gamREG), lwd = 1.1)+
labs(y = 'Length (cm)', x= 'Age (years)', col = "") +
facet_wrap(~Sex , ncol = 4)
ggsave(plot = (p2  / p3),
file = paste0("./figures/FigX_GrowthCurves.png"),
width = 17, height = 10, units = 'in', dpi = 720)
