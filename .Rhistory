# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM')
assRec <- read.csv(here('input','downloads','AssessmentDat_thru2018.csv'),fileEncoding="UTF-8-BOM") %>%
mutate(REG = substr(Index,1,2)) %>%
filter(Type == 'Recruitment') %>%
select(Year, Value, REG) %>%
melt(id = c('Year', 'REG')) %>%
select(-variable) %>%
mutate(variable = REG) %>%
# group_by(REG) %>%
# summarise(stdRec = value/mean(value)) %>%
# ungroup() %>%
# mutate(stdRec = value/mean(value)) %>%
# mutate(Year = yvec$Year) %>%
mutate(variable = REG) %>%
select(-REG) %>%
mutate(SRC = 'Assessment') %>%
filter(Year > 1959) %>%
select(Year, variable, Value, SRC)
read.csv(here('input','downloads','AssessmentDat_thru2018.csv'),fileEncoding="UTF-8-BOM") %>%
mutate(REG = substr(Index,1,2)) %>%
filter(Type == 'Recruitment') %>%
select(Year, Value, REG) %>%
melt(id = c('Year', 'REG')) %>%
select(-variable) %>%
mutate(variable = REG)
assRec <- read.csv(here('input','downloads','AssessmentDat_thru2018.csv'),fileEncoding="UTF-8-BOM") %>%
mutate(REG = substr(Index,1,2)) %>%
filter(Type == 'Recruitment') %>%
select(Year, Value, REG) %>%
melt(id = c('Year', 'REG')) %>%
select(-variable) %>%
mutate(variable = REG) %>%
# group_by(REG) %>%
# summarise(stdRec = value/mean(value)) %>%
# ungroup() %>%
# mutate(stdRec = value/mean(value)) %>%
# mutate(Year = yvec$Year) %>%
mutate(variable = REG) %>%
select(-REG) %>%
mutate(SRC = 'Assessment') %>%
filter(Year > 1959) %>%
select(Year, variable, value, SRC)
R_ym <- data.frame(dat$R_ym)
names(R_ym) <- c('WC','BC','AK')
yvec <-   R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>% select(Year)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = mgmtPal) +
labs(x = 'Year', y = 'Mean-Normalized Recruitment',
title = '') +
facet_wrap(~variable+SRC, scale = 'free_y')
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = mgmtPal) +
labs(x = 'Year', y = 'Mean-Normalized Recruitment',
title = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = mgmtPal) +
labs(x = 'Year', y = 'Raw Recruitment',
title = '', fill = '',linetype = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = mgmtPal) +
labs(x = 'Year', y = 'Raw Recruitment',
title = '', color = '',linetype = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = rev(mgmtPal)) +
labs(x = 'Year', y = 'Raw Recruitment',
title = '', color = '',linetype = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = rev(mgmtPal)) +
labs(x = 'Year', y = 'Raw Recruitment',
subtitle = 'Assessment values taken from Tech Memo', color = '',linetype = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'OM') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = rev(mgmtPal)) +
labs(x = 'Year', y = 'Raw Recruitment',
subtitle = 'Assessment values taken from Fenske et. al. 2018',
color = '',linetype = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
R_ym %>% data.frame() %>%
mutate(Year = 1960:2019) %>%
melt(id = 'Year') %>%
# group_by(variable) %>%
# mutate(stdRec = value/mean(value)) %>%
# summarise(stdRec = value/mean(value)) %>%
# select(-value) %>%
# mutate(Year = yvec$Year) %>%
mutate(SRC = 'Operating Model') %>%
# mutate(variable = paste("OM_",variable)) %>%
rbind(., assRec) %>%
ggplot(., aes(x = Year, y = value, col = variable, linetype = SRC)) +
geom_line(lwd = 1) +
theme_sleek() +
scale_linetype_manual(values = c('dotted','solid'))+
scale_color_manual(values = rev(mgmtPal)) +
labs(x = 'Year', y = 'Raw Recruitment',
subtitle = 'Assessment values taken from Fenske et. al. 2018',
color = '',linetype = '') +
facet_wrap(~variable+SRC, scale = 'free_y', ncol = 2)
plot(best[names(best) == 'tildeR_y'] [1:59],
type = 'b',
pch = 19,
xlab = 'Year',
xaxt = 'n',
col = 'grey44',
ylab = 'Log Recruitment Deviation',
ylim = c(4*min(best[names(best) == 'tildeR_y'] ),1.2*max(best[names(best) == 'tildeR_y'] )))
axis(side = 1, at = seq(0,60,5), labels= seq(1960,2020,5))
abline(h=0,col = 'blue')
lines(wcrd$Value[wcrd$Year >1959], col = mgmtPal[3], pch = 19, lwd = 2)
legend('bottomleft',
legend = c('OM','WC-2019','BC','AK'),
pch = c(19,NA,NA,NA),
lty = c(NA,1,1,1),
lwd = 2,
col = c('grey44',rev(mgmtPal))
)
plot(best[names(best) == 'tildeR_y'] [1:59],
type = 'b',
pch = 19,
xlab = 'Year',
xaxt = 'n',
col = 'grey44',
ylab = 'Log Recruitment Deviation',
ylim = c(4*min(best[names(best) == 'tildeR_y'] ),1.2*max(best[names(best) == 'tildeR_y'] )))
axis(side = 1, at = seq(0,60,5), labels= seq(1960,2020,5))
abline(h=0,col = 'blue')
lines(wcrd$Value[wcrd$Year >1959], col = mgmtPal[3], pch = 19, lwd = 2)
legend('bottomleft',
cex = 0.5,
legend = c('OM','WC-2019','BC-placeholder','AK-placeholder'),
pch = c(19,NA,NA,NA),
lty = c(NA,1,1,1),
lwd = 2,
col = c('grey44',rev(mgmtPal))
)
legend('bottomleft',
cex = 1,
legend = c('OM','WC-2019','BC-placeholder','AK-placeholder'),
pch = c(19,NA,NA,NA),
lty = c(NA,1,1,1),
lwd = 2,
col = c('grey44',rev(mgmtPal))
)
legend('bottomleft',
cex = 0.8,
legend = c('OM','WC-2019','BC-placeholder','AK-placeholder'),
pch = c(19,NA,NA,NA),
lty = c(NA,1,1,1),
lwd = 2,
col = c('grey44',rev(mgmtPal))
)
plot(best[names(best) == 'tildeR_y'] [1:59],
type = 'b',
pch = 19,
xlab = 'Year',
xaxt = 'n',
col = 'grey44',
ylab = 'Log Recruitment Deviation',
ylim = c(4*min(best[names(best) == 'tildeR_y'] ),1.2*max(best[names(best) == 'tildeR_y'] )))
axis(side = 1, at = seq(0,60,5), labels= seq(1960,2020,5))
abline(h=0,col = 'blue')
lines(wcrd$Value[wcrd$Year >1959], col = mgmtPal[3], pch = 19, lwd = 2)
legend('bottomleft',
cex = 0.8,
legend = c('OM','WC-2019','BC-placeholder','AK-placeholder'),
pch = c(19,NA,NA,NA),
lty = c(NA,1,1,1),
lwd = 2,
col = c('grey44',rev(mgmtPal))
)
r = 1
plot(best[names(best) == 'tildeR_y'] [1:59],
type = 'b',
pch = 19,
xlab = 'Year',
xaxt = 'n',
col = 'grey44',
ylab = 'Log Recruitment Deviation',
ylim = c(4*min(best[names(best) == 'tildeR_y'] ),1.2*max(best[names(best) == 'tildeR_y'] )))
axis(side = 1, at = seq(0,60,5), labels= seq(1960,2020,5))
abline(h=0,col = 'blue')
r = 2
plot(best[names(best) == 'tildeR_y'] [1:59],
type = 'b',
pch = 19,
xlab = 'Year',
xaxt = 'n',
col = 'grey44',
ylab = 'Log Recruitment Deviation',
ylim = c(4*min(best[names(best) == 'tildeR_y'] ),1.2*max(best[names(best) == 'tildeR_y'] )))
axis(side = 1, at = seq(0,60,5), labels= seq(1960,2020,5))
abline(h=0,col = 'blue')
if(r == 2){
lines(wcrd$Value[wcrd$Year >1959], col = mgmtPal[3], pch = 19, lwd = 2)
legend('bottomleft',
cex = 0.8,
legend = c('OM','WC-2019','BC-placeholder','AK-placeholder'),
pch = c(19,NA,NA,NA),
lty = c(NA,1,1,1),
lwd = 2,
col = c('grey44',rev(mgmtPal))
)
}
## ssb_yk ----
SSB_yk <- data.frame(dat$SSB_yk)
names(SSB_yk) <- c(paste('Stock',1:4))
ssbyk_plot <- SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = demPal) +
geom_line(lwd = 2) + labs(x = 'Modeled Year',y = 'SSB', color = 'stock') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek() +
theme( legend.position = c(0.8,0.8))
years
years <- 1960:2019
nyear <- length(years)
tEnd <- length(years)
age <- 0:70
nage <- length(age)
ssbyk_plot <- SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = demPal) +
geom_line(lwd = 2) + labs(x = 'Modeled Year',y = 'SSB', color = 'stock') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek() +
theme( legend.position = c(0.8,0.8))
ssbyk_plot
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = demPal) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek() +
theme(legend.position = c(0.8,0.8))
head(SSB_yk)
summarise(SSB_yk)
table(SSB_yk)
SSB_yk %>% melt() %>% summarise(mean = mean())
SSB_yk %>% melt() %>% summarise(mean = mean(value))
SSB_yk %>% melt() %>% group_by(variable) %>% summarise(mean = mean(value))
ssbyk_plot <- SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek() +
theme(legend.position = c(0.8,0.8))
ssbyk_plot
ssbyk_plot <- SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18) +
theme(legend.position = c(0.8,0.8))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18) +
theme(legend.position = c(0.8,0.8))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18,
panel.background = element_rect(fill=demPal[1])) +
theme(legend.position = c(0.8,0.8))
ssbyk_plot <- SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
panel.background = element_rect(fill=demPal[1]))
ssbyk_plot
demPal
ssbyk_plot <- SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
panel.background = element_rect(fill="#02A29C"))
ssbyk_plot
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
panel.background = element_rect(fill="#002827"))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
panel.background = element_rect(fill="#002827"),
plot.background = element_rect(fill = "#002827"))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
axis.text = element_text(color = "white"),
panel.background = element_rect(fill="#002827"),
plot.background = element_rect(fill = "#002827"))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
axis.title = element_text(color = 'white'),
axis.text = element_text(color = "white"),
panel.background = element_rect(fill="#002827"),
plot.background = element_rect(fill = "#002827"))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
legend.text  = element_text(color = "white"),
axis.title = element_text(color = 'white'),
axis.text = element_text(color = "white"),
panel.background = element_rect(fill="#002827"),
plot.background = element_rect(fill = "#002827"))
dempal
demPal
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18)+
theme(legend.position = c(0.8,0.8),
legend.text  = element_text(color = "white"),
axis.title = element_text(color = 'white'),
axis.text = element_text(color = "white"),
panel.background = element_rect(fill="#01514E"),
plot.background = element_rect(fill = "#01514E"))
SSB_yk %>%
mutate('Yr' = years[1:nrow(.)]) %>%
reshape2::melt(id = c('Yr')) %>%
ggplot(., aes(x = Yr, y = value, color = variable )) +
scale_color_manual(values = rev(demPal)) +
geom_line(lwd = 2) +
labs(x = 'Modeled Year',y = 'SSB', color = '') +
scale_x_continuous(limits = c(1960,1959+df$yRun)) +
ggsidekick::theme_sleek(base_size = 18) +
theme(legend.position = c(0.8,0.8))
